<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Moon Test</title>
      <script src="https://aframe.io/releases/0.3.0/aframe.min.js"></script>
      <script src="../index.js"></script>
      <script src="https://cdn.rawgit.com/AltspaceVR/aframe-altspace-component/v1.1.1/dist/aframe-altspace-component.min.js"></script>
	<script src="https://cdn.rawgit.com/mrdoob/three.js/r74/build/three.min.js"></script>
	<script src="https://cdn.rawgit.com/mrdoob/three.js/r74/examples/js/loaders/MTLLoader.js"></script>
	<script src="https://cdn.rawgit.com/mrdoob/three.js/r74/examples/js/loaders/OBJLoader.js"></script>
    </head>
  <body>
    <!-- set up the scene -->
    <a-scene altspace= "fullspace: true" position="0 -360 0">
 
    <!-- preload all our textures -->
    <a-assets>
        <img id='earth' crossorigin src='https://cdn.rawgit.com/Sven118/Svens-Apps/master/moontest-master/moontest/models/earth.jpg'/>
        <img id='stars' crossorigin src='https://cdn.rawgit.com/Sven118/Svens-Apps/master/moontest-master/moontest/models/stars.jpg'/>
        <img id='moon' crossorigin src='https://cdn.rawgit.com/Sven118/Svens-Apps/master/moontest-master/moontest/models/moon.jpg'/>
        <img id='sun' crossorigin src='https://cdn.rawgit.com/Sven118/Svens-Apps/master/moontest-master/moontest/models/sun.jpg'/>
        <img id='jupiter' crossorigin src='https://cdn.rawgit.com/Sven118/Svens-Apps/master/moontest-master/moontest/models/Jupiter.jpg'/>
        <img id='mars' crossorigin src='https://cdn.rawgit.com/Sven118/Svens-Apps/master/moontest-master/moontest/models/Mars.jpg'/>
        <img id='saturn' crossorigin src='https://cdn.rawgit.com/Sven118/Svens-Apps/master/moontest-master/moontest/models/saturn.jpg'/>
        <img id="ring" src="https://cdn.rawgit.com/Sven118/Svens-Apps/master/moontest-master/moontest/models/satring.png">
        <img id='venus' crossorigin src='https://cdn.rawgit.com/Sven118/Svens-Apps/master/moontest-master/moontest/models/venus.jpg'/>
        <img id='mercury' crossorigin src='https://cdn.rawgit.com/Sven118/Svens-Apps/master/moontest-master/moontest/models/mercury.jpg'/>
        <img id='uranus' crossorigin src='https://cdn.rawgit.com/Sven118/Svens-Apps/master/moontest-master/moontest/models/uranus.jpg'/>
        <img id='uranusring' crossorigin src='https://cdn.rawgit.com/Sven118/Svens-Apps/master/moontest-master/moontest/models/uranusring.png'/>
        <img id='neptune' crossorigin src='https://cdn.rawgit.com/Sven118/Svens-Apps/master/moontest-master/moontest/models/neptune.jpg'/>
        <img id="floor" src="https://cdn.rawgit.com/Sven118/Svens-Apps/master/moontest-master/moontest/models/floor.jpg">
        <img id="clouds" crossorigin src="https://cdn.rawgit.com/Sven118/Svens-Apps/master/moontest-master/moontest/models/clouds1.png">
        <a-asset-item id="ship-obj" crossorigin src="https://cdn.rawgit.com/Sven118/Svens-Apps/master/moontest-master/moontest/spaceshiptest1.obj"></a-asset-item>
        <a-asset-item id="ship-mtl" crossorigin src="https://cdn.rawgit.com/Sven118/Svens-Apps/master/moontest-master/moontest/spaceshiptest1.mtl"></a-asset-item>
        <a-asset-item id="ring-obj" crossorigin src="https://cdn.rawgit.com/Sven118/Svens-Apps/master/moontest-master/moontest/ring.obj"></a-asset-item>
        <a-asset-item id="ring-mtl" crossorigin src="https://cdn.rawgit.com/Sven118/Svens-Apps/master/moontest-master/moontest/ring.mtl"></a-asset-item>
        </a-assets>

      <!-- Add Planets -->
     <a-sphere position='1000 0 500' radius='250' material='src: #earth;'>
        <a-animation to='0 360 0' easing='linear' dur='400000' repeat='indefinite'/>
    </a-sphere>
      
      <a-entity id="earth" geometry="primitive: sphere; radius: 5" 
            material="color: #FFC107"
            position="1000 0 500">
       <a-entity id="moonOrbit">
            <a-animation attribute="rotation"
                 dur="305000"
                 to="0 360 0"
                 repeat="indefinite" 
                 easing="linear"></a-animation>
            <a-entity id="moon" geometry="primitive: sphere; radius: 50" 
              material="src: #moon;"
              position="-1300 50 0"></a-entity>
            </a-entity>
        </a-entity>
      
     <a-sphere position='1000 0 500' radius='256' transparent='true' material='src: #clouds;'>
        <a-animation to='0 360 0' easing='linear' dur='550000' repeat='indefinite'/>
    </a-sphere>
      
     <a-sphere position='0 500 -1500' radius='60' material='src: #jupiter;'>
        <!-- add an animation to make it rotate -->
        <a-animation to='0 360 0' easing='linear' dur='100000' repeat='indefinite'/>
      </a-sphere>
      
      <a-sphere position='0 700 2000' radius='50' material='src: #sun;'>
        <!-- add an animation to make it rotate -->
        <a-animation to='0 360 0' easing='linear' dur='20000' repeat='indefinite'/>
      </a-sphere>
      
      <a-sphere position='400 100 -500' radius='25' material='src: #mars;'>
        <!-- add an animation to make it rotate -->
        <a-animation to='0 360 0' easing='linear' dur='100000' repeat='indefinite'/>
      </a-sphere>
      
      <a-sphere position='-1000 200 -2000' radius='40' rotation='0 90 0' material='src: #saturn;'>
        <!-- add an animation to make it rotate -->
        <a-animation to='0 360 0' easing='linear' dur='100000' repeat='indefinite'/>
      </a-sphere>
      
      <a-sphere position='-200 300 700' radius='30' material='src: #venus;'>
        <!-- add an animation to make it rotate -->
        <a-animation to='0 360 0' easing='linear' dur='250000' repeat='indefinite'/>
      </a-sphere>
      
      <a-entity id="sun" geometry="primitive: sphere; radius: 1" 
            material="color: #FFC107"
            position='0 700 2000'>
      <a-entity id="mercuryOrbit">
         <a-animation attribute="rotation"
                 dur="100000"
                 to="0 360 0"
                 repeat="indefinite" 
                 easing="linear"></a-animation>
           <a-entity id="mercury" geometry="primitive: sphere; radius: 10" 
              material="src: #mercury;"
              position="60 -30 0"></a-entity>
           </a-entity>
      </a-entity>
      
      <a-sphere position='2000 -100 -300' radius='20' rotation='0 90 0' material='src: #uranus;'>
        <!-- add an animation to make it rotate -->
        <a-animation to='360 0 0' easing='linear' dur='100000' repeat='indefinite'/>
      </a-sphere>
      
      <a-sphere position='-2000 50 -500' radius='15' rotation='0 90 0' material='src: #neptune;'>
        <!-- add an animation to make it rotate -->
        <a-animation to='0 360 0' easing='linear' dur='100000' repeat='indefinite'/>
      </a-sphere>
            
      <a-box material='src: #floor;' position='0 .005 0' depth="128" height="0" width="128" class="not-clickable" 
            altspace-collider="enabled: false">
      </a-box>
       
      <a-ring src="#ring" position='-1000 200 -2000' radius-inner='40' radius-outer='110' side='double' rotation='90 90 45'></a-ring>
      <a-ring src="#uranusring" position='2000 -100 -300' radius-inner='30' radius-outer='50' side='double' rotation='0 45 0'></a-ring>
      
      <!-- Add Spaceship -->
      <a-entity obj-model="obj: #ship-obj; mtl: #ship-mtl" position='0 -35 0' scale='70 70 70' class="not-clickable" altspace-collider="enabled: false"></a-entity>
      <a-entity obj-model="obj: #ring-obj; mtl: #ring-mtl" position='0 -35 0' scale='70 70 70' class="not-clickable" altspace-collider="enabled: false">
        <a-animation to='0 0 360' easing='linear' dur='800000' repeat='indefinite'/>
      </a-entity>
      
      <script>
TouchpadCube = (function () {
    var utilities = altspace.utilities;
    var behaviors = altspace.utilities.behaviors;
	var sim;
	var sceneSync;
	var cube;
	var cubeModel;
	// Setup
	function main() {
	    sim = utilities.Simulation();
		loadCubeModel();//must load model before creating synced cube
	}
	function onModelReady() {
	    var inCodePen = utilities.codePen.inCodePen;
	    utilities.sync.connect({
            appId: "TouchpadCube",
	        authorId: inCodePen ? utilities.codePen.getAuthorId() : "AltspaceVR",
	        instanceId: inCodePen ? utilities.codePen.getPenId() : null
	    }).then(function (connection) {
	        sceneSync = behaviors.SceneSync(connection.instance, {
	            instantiators: { 'Cube': createCube },
	            ready: ready
	        });
	        sim.scene.addBehavior(sceneSync);
	    });
	}
	function loadCubeModel() {
		var loader = new altspace.utilities.shims.OBJMTLLoader();
		var objFilename = "models/cube/cube-colored-faces.obj";
		var mtlFilename = "models/cube/cube-colored-faces.mtl";
		loader.load(objFilename, mtlFilename, function ( obj ) {
			cubeModel = obj;
			onModelReady();
		});
	}
	function createCube(initData) {
		cube = cubeModel.clone();
		cube.scale.multiplyScalar(15);
		cube.addBehaviors(
			behaviors.Object3DSync({ position: true, rotation: true, scale: true }),
			behaviors.TouchpadRotate()
		);
		cube.name = 'cube';
		cube.rotation.y += Math.PI / 8;
		cube.rotation.x += Math.PI / 12;
		sim.scene.add(cube);
		return cube;
	}
	function ready(firstInstance) {
		if (firstInstance) {
			sceneSync.instantiate('Cube');
		}
	}
	return { 
		main: main,
		getCube: function(){ return cube; },
	};
}());
TouchpadCube.main();
</script>
      
      <a-sky src='#stars' radius='2500' class="not-clickable"></a-sky>
      

    <!-- add a view camera (2d only) -->
    <a-entity position='0 0 2'>
        <a-camera></a-camera>
    </a-entity>
 
    </a-scene>
 
  </body>
</html>
